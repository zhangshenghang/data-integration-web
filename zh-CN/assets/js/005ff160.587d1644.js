"use strict";(self.webpackChunkseatunnel_website=self.webpackChunkseatunnel_website||[]).push([[54003],{15680:(e,t,n)=>{n.d(t,{xA:()=>d,yg:()=>m});var a=n(96540);function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,a,l=function(e,t){if(null==e)return{};var n,a,l={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(l[n]=e[n]);return l}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}var s=a.createContext({}),g=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},d=function(e){var t=g(e.components);return a.createElement(s.Provider,{value:t},e.children)},p="mdxType",y={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var n=e.components,l=e.mdxType,r=e.originalType,s=e.parentName,d=o(e,["components","mdxType","originalType","parentName"]),p=g(n),u=l,m=p["".concat(s,".").concat(u)]||p[u]||y[u]||r;return n?a.createElement(m,i(i({ref:t},d),{},{components:n})):a.createElement(m,i({ref:t},d))}));function m(e,t){var n=arguments,l=t&&t.mdxType;if("string"==typeof e||l){var r=n.length,i=new Array(r);i[0]=u;var o={};for(var s in t)hasOwnProperty.call(t,s)&&(o[s]=t[s]);o.originalType=e,o[p]="string"==typeof e?e:l,i[1]=o;for(var g=2;g<r;g++)i[g]=n[g];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},11596:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>i,default:()=>y,frontMatter:()=>r,metadata:()=>o,toc:()=>g});var a=n(58168),l=(n(96540),n(15680));const r={},i="ClickhouseFile",o={unversionedId:"connector/sink/ClickhouseFile",id:"version-2.3.0-beta/connector/sink/ClickhouseFile",title:"ClickhouseFile",description:"Clickhouse file sink connector",source:"@site/versioned_docs/version-2.3.0-beta/connector/sink/ClickhouseFile.md",sourceDirName:"connector/sink",slug:"/connector/sink/ClickhouseFile",permalink:"/zh-CN/docs/2.3.0-beta/connector/sink/ClickhouseFile",draft:!1,editUrl:"https://github.com/apache/seatunnel-website/edit/main/versioned_docs/version-2.3.0-beta/connector/sink/ClickhouseFile.md",tags:[],version:"2.3.0-beta",frontMatter:{},sidebar:"docs",previous:{title:"Clickhouse",permalink:"/zh-CN/docs/2.3.0-beta/connector/sink/Clickhouse"},next:{title:"Console",permalink:"/zh-CN/docs/2.3.0-beta/connector/sink/Console"}},s={},g=[{value:"Description",id:"description",level:2},{value:"Options",id:"options",level:2},{value:"database string",id:"database-string",level:3},{value:"fields array",id:"fields-array",level:3},{value:"host string",id:"host-string",level:3},{value:"password string",id:"password-string",level:3},{value:"table string",id:"table-string",level:3},{value:"username string",id:"username-string",level:3},{value:"sharding_key string",id:"sharding_key-string",level:3},{value:"clickhouse_local_path string",id:"clickhouse_local_path-string",level:3},{value:"tmp_batch_cache_line int",id:"tmp_batch_cache_line-int",level:3},{value:"copy_method string",id:"copy_method-string",level:3},{value:"node_free_password boolean",id:"node_free_password-boolean",level:3},{value:"node_pass list",id:"node_pass-list",level:3},{value:"node_pass.node_address string",id:"node_passnode_address-string",level:3},{value:"node_pass.node_password string",id:"node_passnode_password-string",level:3},{value:"common options string",id:"common-options-string",level:3},{value:"ClickHouse type comparison table",id:"clickhouse-type-comparison-table",level:2},{value:"Examples",id:"examples",level:2}],d={toc:g},p="wrapper";function y(e){let{components:t,...n}=e;return(0,l.yg)(p,(0,a.A)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,l.yg)("h1",{id:"clickhousefile"},"ClickhouseFile"),(0,l.yg)("blockquote",null,(0,l.yg)("p",{parentName:"blockquote"},"Clickhouse file sink connector")),(0,l.yg)("h2",{id:"description"},"Description"),(0,l.yg)("p",null,"Generate the clickhouse data file with the clickhouse-local program, and then send it to the clickhouse\nserver, also call bulk load."),(0,l.yg)("admonition",{type:"tip"},(0,l.yg)("p",{parentName:"admonition"},"Engine Supported and plugin name"),(0,l.yg)("ul",{parentName:"admonition",className:"contains-task-list"},(0,l.yg)("li",{parentName:"ul",className:"task-list-item"},(0,l.yg)("input",{parentName:"li",type:"checkbox",checked:!0,disabled:!0})," ","Spark: ClickhouseFile"),(0,l.yg)("li",{parentName:"ul",className:"task-list-item"},(0,l.yg)("input",{parentName:"li",type:"checkbox",checked:!0,disabled:!0})," ","Flink"))),(0,l.yg)("h2",{id:"options"},"Options"),(0,l.yg)("table",null,(0,l.yg)("thead",{parentName:"table"},(0,l.yg)("tr",{parentName:"thead"},(0,l.yg)("th",{parentName:"tr",align:null},"name"),(0,l.yg)("th",{parentName:"tr",align:null},"type"),(0,l.yg)("th",{parentName:"tr",align:null},"required"),(0,l.yg)("th",{parentName:"tr",align:null},"default value"))),(0,l.yg)("tbody",{parentName:"table"},(0,l.yg)("tr",{parentName:"tbody"},(0,l.yg)("td",{parentName:"tr",align:null},"database"),(0,l.yg)("td",{parentName:"tr",align:null},"string"),(0,l.yg)("td",{parentName:"tr",align:null},"yes"),(0,l.yg)("td",{parentName:"tr",align:null},"-")),(0,l.yg)("tr",{parentName:"tbody"},(0,l.yg)("td",{parentName:"tr",align:null},"fields"),(0,l.yg)("td",{parentName:"tr",align:null},"array"),(0,l.yg)("td",{parentName:"tr",align:null},"no"),(0,l.yg)("td",{parentName:"tr",align:null},"-")),(0,l.yg)("tr",{parentName:"tbody"},(0,l.yg)("td",{parentName:"tr",align:null},"host"),(0,l.yg)("td",{parentName:"tr",align:null},"string"),(0,l.yg)("td",{parentName:"tr",align:null},"yes"),(0,l.yg)("td",{parentName:"tr",align:null},"-")),(0,l.yg)("tr",{parentName:"tbody"},(0,l.yg)("td",{parentName:"tr",align:null},"password"),(0,l.yg)("td",{parentName:"tr",align:null},"string"),(0,l.yg)("td",{parentName:"tr",align:null},"no"),(0,l.yg)("td",{parentName:"tr",align:null},"-")),(0,l.yg)("tr",{parentName:"tbody"},(0,l.yg)("td",{parentName:"tr",align:null},"table"),(0,l.yg)("td",{parentName:"tr",align:null},"string"),(0,l.yg)("td",{parentName:"tr",align:null},"yes"),(0,l.yg)("td",{parentName:"tr",align:null},"-")),(0,l.yg)("tr",{parentName:"tbody"},(0,l.yg)("td",{parentName:"tr",align:null},"username"),(0,l.yg)("td",{parentName:"tr",align:null},"string"),(0,l.yg)("td",{parentName:"tr",align:null},"no"),(0,l.yg)("td",{parentName:"tr",align:null},"-")),(0,l.yg)("tr",{parentName:"tbody"},(0,l.yg)("td",{parentName:"tr",align:null},"sharding_key"),(0,l.yg)("td",{parentName:"tr",align:null},"string"),(0,l.yg)("td",{parentName:"tr",align:null},"no"),(0,l.yg)("td",{parentName:"tr",align:null},"-")),(0,l.yg)("tr",{parentName:"tbody"},(0,l.yg)("td",{parentName:"tr",align:null},"clickhouse_local_path"),(0,l.yg)("td",{parentName:"tr",align:null},"string"),(0,l.yg)("td",{parentName:"tr",align:null},"yes"),(0,l.yg)("td",{parentName:"tr",align:null},"-")),(0,l.yg)("tr",{parentName:"tbody"},(0,l.yg)("td",{parentName:"tr",align:null},"tmp_batch_cache_line"),(0,l.yg)("td",{parentName:"tr",align:null},"int"),(0,l.yg)("td",{parentName:"tr",align:null},"no"),(0,l.yg)("td",{parentName:"tr",align:null},"100000")),(0,l.yg)("tr",{parentName:"tbody"},(0,l.yg)("td",{parentName:"tr",align:null},"copy_method"),(0,l.yg)("td",{parentName:"tr",align:null},"string"),(0,l.yg)("td",{parentName:"tr",align:null},"no"),(0,l.yg)("td",{parentName:"tr",align:null},"scp")),(0,l.yg)("tr",{parentName:"tbody"},(0,l.yg)("td",{parentName:"tr",align:null},"node_free_password"),(0,l.yg)("td",{parentName:"tr",align:null},"boolean"),(0,l.yg)("td",{parentName:"tr",align:null},"no"),(0,l.yg)("td",{parentName:"tr",align:null},"false")),(0,l.yg)("tr",{parentName:"tbody"},(0,l.yg)("td",{parentName:"tr",align:null},"node_pass"),(0,l.yg)("td",{parentName:"tr",align:null},"list"),(0,l.yg)("td",{parentName:"tr",align:null},"no"),(0,l.yg)("td",{parentName:"tr",align:null},"-")),(0,l.yg)("tr",{parentName:"tbody"},(0,l.yg)("td",{parentName:"tr",align:null},"node_pass.node_address"),(0,l.yg)("td",{parentName:"tr",align:null},"string"),(0,l.yg)("td",{parentName:"tr",align:null},"no"),(0,l.yg)("td",{parentName:"tr",align:null},"-")),(0,l.yg)("tr",{parentName:"tbody"},(0,l.yg)("td",{parentName:"tr",align:null},"node_pass.password"),(0,l.yg)("td",{parentName:"tr",align:null},"string"),(0,l.yg)("td",{parentName:"tr",align:null},"no"),(0,l.yg)("td",{parentName:"tr",align:null},"-")),(0,l.yg)("tr",{parentName:"tbody"},(0,l.yg)("td",{parentName:"tr",align:null},"common-options"),(0,l.yg)("td",{parentName:"tr",align:null},"string"),(0,l.yg)("td",{parentName:"tr",align:null},"no"),(0,l.yg)("td",{parentName:"tr",align:null},"-")))),(0,l.yg)("h3",{id:"database-string"},"database ","[string]"),(0,l.yg)("p",null,"database name"),(0,l.yg)("h3",{id:"fields-array"},"fields ","[array]"),(0,l.yg)("p",null,"The data field that needs to be output to ",(0,l.yg)("inlineCode",{parentName:"p"},"ClickHouse")," , if not configured, it will be automatically adapted according to the data ",(0,l.yg)("inlineCode",{parentName:"p"},"schema")," ."),(0,l.yg)("h3",{id:"host-string"},"host ","[string]"),(0,l.yg)("p",null,(0,l.yg)("inlineCode",{parentName:"p"},"ClickHouse")," cluster address, the format is ",(0,l.yg)("inlineCode",{parentName:"p"},"host:port")," , allowing multiple ",(0,l.yg)("inlineCode",{parentName:"p"},"hosts")," to be specified. Such as ",(0,l.yg)("inlineCode",{parentName:"p"},'"host1:8123,host2:8123"')," ."),(0,l.yg)("h3",{id:"password-string"},"password ","[string]"),(0,l.yg)("p",null,(0,l.yg)("inlineCode",{parentName:"p"},"ClickHouse user password")," . This field is only required when the permission is enabled in ",(0,l.yg)("inlineCode",{parentName:"p"},"ClickHouse")," ."),(0,l.yg)("h3",{id:"table-string"},"table ","[string]"),(0,l.yg)("p",null,"table name"),(0,l.yg)("h3",{id:"username-string"},"username ","[string]"),(0,l.yg)("p",null,(0,l.yg)("inlineCode",{parentName:"p"},"ClickHouse")," user username, this field is only required when permission is enabled in ",(0,l.yg)("inlineCode",{parentName:"p"},"ClickHouse")),(0,l.yg)("h3",{id:"sharding_key-string"},"sharding_key ","[string]"),(0,l.yg)("p",null,"When use split_mode, which node to send data to is a problem, the default is random selection, but the\n'sharding_key' parameter can be used to specify the field for the sharding algorithm. This option only\nworked when 'split_mode' is true."),(0,l.yg)("h3",{id:"clickhouse_local_path-string"},"clickhouse_local_path ","[string]"),(0,l.yg)("p",null,"The address of the clickhouse-local program on the spark node. Since each task needs to be called,\nclickhouse-local should be located in the same path of each spark node."),(0,l.yg)("h3",{id:"tmp_batch_cache_line-int"},"tmp_batch_cache_line ","[int]"),(0,l.yg)("p",null,"SeaTunnel will use memory map technology to write temporary data to the file to cache the data that the\nuser needs to write to clickhouse. This parameter is used to configure the number of data pieces written\nto the file each time. Most of the time you don't need to modify it."),(0,l.yg)("h3",{id:"copy_method-string"},"copy_method ","[string]"),(0,l.yg)("p",null,"Specifies the method used to transfer files, the default is scp, optional scp and rsync"),(0,l.yg)("h3",{id:"node_free_password-boolean"},"node_free_password ","[boolean]"),(0,l.yg)("p",null,"Because seatunnel need to use scp or rsync for file transfer, seatunnel need clickhouse server-side access.\nIf each spark node and clickhouse server are configured with password-free login,\nyou can configure this option to true, otherwise you need to configure the corresponding node password in the node_pass configuration"),(0,l.yg)("h3",{id:"node_pass-list"},"node_pass ","[list]"),(0,l.yg)("p",null,"Used to save the addresses and corresponding passwords of all clickhouse servers"),(0,l.yg)("h3",{id:"node_passnode_address-string"},"node_pass.node_address ","[string]"),(0,l.yg)("p",null,"The address corresponding to the clickhouse server"),(0,l.yg)("h3",{id:"node_passnode_password-string"},"node_pass.node_password ","[string]"),(0,l.yg)("p",null,"The password corresponding to the clickhouse server, only support root user yet."),(0,l.yg)("h3",{id:"common-options-string"},"common options ","[string]"),(0,l.yg)("p",null,"Sink plugin common parameters, please refer to ",(0,l.yg)("a",{parentName:"p",href:"/zh-CN/docs/2.3.0-beta/connector/sink/common-options"},"common options")," for details"),(0,l.yg)("h2",{id:"clickhouse-type-comparison-table"},"ClickHouse type comparison table"),(0,l.yg)("table",null,(0,l.yg)("thead",{parentName:"table"},(0,l.yg)("tr",{parentName:"thead"},(0,l.yg)("th",{parentName:"tr",align:null},"ClickHouse field type"),(0,l.yg)("th",{parentName:"tr",align:null},"Convert plugin conversion goal type"),(0,l.yg)("th",{parentName:"tr",align:null},"SQL conversion expression"),(0,l.yg)("th",{parentName:"tr",align:null},"Description"))),(0,l.yg)("tbody",{parentName:"table"},(0,l.yg)("tr",{parentName:"tbody"},(0,l.yg)("td",{parentName:"tr",align:null},"Date"),(0,l.yg)("td",{parentName:"tr",align:null},"string"),(0,l.yg)("td",{parentName:"tr",align:null},"string()"),(0,l.yg)("td",{parentName:"tr",align:null},(0,l.yg)("inlineCode",{parentName:"td"},"yyyy-MM-dd"),"\xa0Format string")),(0,l.yg)("tr",{parentName:"tbody"},(0,l.yg)("td",{parentName:"tr",align:null},"DateTime"),(0,l.yg)("td",{parentName:"tr",align:null},"string"),(0,l.yg)("td",{parentName:"tr",align:null},"string()"),(0,l.yg)("td",{parentName:"tr",align:null},(0,l.yg)("inlineCode",{parentName:"td"},"yyyy-MM-dd HH:mm:ss"),"\xa0Format string")),(0,l.yg)("tr",{parentName:"tbody"},(0,l.yg)("td",{parentName:"tr",align:null},"String"),(0,l.yg)("td",{parentName:"tr",align:null},"string"),(0,l.yg)("td",{parentName:"tr",align:null},"string()"),(0,l.yg)("td",{parentName:"tr",align:null})),(0,l.yg)("tr",{parentName:"tbody"},(0,l.yg)("td",{parentName:"tr",align:null},"Int8"),(0,l.yg)("td",{parentName:"tr",align:null},"integer"),(0,l.yg)("td",{parentName:"tr",align:null},"int()"),(0,l.yg)("td",{parentName:"tr",align:null})),(0,l.yg)("tr",{parentName:"tbody"},(0,l.yg)("td",{parentName:"tr",align:null},"Uint8"),(0,l.yg)("td",{parentName:"tr",align:null},"integer"),(0,l.yg)("td",{parentName:"tr",align:null},"int()"),(0,l.yg)("td",{parentName:"tr",align:null})),(0,l.yg)("tr",{parentName:"tbody"},(0,l.yg)("td",{parentName:"tr",align:null},"Int16"),(0,l.yg)("td",{parentName:"tr",align:null},"integer"),(0,l.yg)("td",{parentName:"tr",align:null},"int()"),(0,l.yg)("td",{parentName:"tr",align:null})),(0,l.yg)("tr",{parentName:"tbody"},(0,l.yg)("td",{parentName:"tr",align:null},"Uint16"),(0,l.yg)("td",{parentName:"tr",align:null},"integer"),(0,l.yg)("td",{parentName:"tr",align:null},"int()"),(0,l.yg)("td",{parentName:"tr",align:null})),(0,l.yg)("tr",{parentName:"tbody"},(0,l.yg)("td",{parentName:"tr",align:null},"Int32"),(0,l.yg)("td",{parentName:"tr",align:null},"integer"),(0,l.yg)("td",{parentName:"tr",align:null},"int()"),(0,l.yg)("td",{parentName:"tr",align:null})),(0,l.yg)("tr",{parentName:"tbody"},(0,l.yg)("td",{parentName:"tr",align:null},"Uint32"),(0,l.yg)("td",{parentName:"tr",align:null},"long"),(0,l.yg)("td",{parentName:"tr",align:null},"bigint()"),(0,l.yg)("td",{parentName:"tr",align:null})),(0,l.yg)("tr",{parentName:"tbody"},(0,l.yg)("td",{parentName:"tr",align:null},"Int64"),(0,l.yg)("td",{parentName:"tr",align:null},"long"),(0,l.yg)("td",{parentName:"tr",align:null},"bigint()"),(0,l.yg)("td",{parentName:"tr",align:null})),(0,l.yg)("tr",{parentName:"tbody"},(0,l.yg)("td",{parentName:"tr",align:null},"Uint64"),(0,l.yg)("td",{parentName:"tr",align:null},"long"),(0,l.yg)("td",{parentName:"tr",align:null},"bigint()"),(0,l.yg)("td",{parentName:"tr",align:null})),(0,l.yg)("tr",{parentName:"tbody"},(0,l.yg)("td",{parentName:"tr",align:null},"Float32"),(0,l.yg)("td",{parentName:"tr",align:null},"float"),(0,l.yg)("td",{parentName:"tr",align:null},"float()"),(0,l.yg)("td",{parentName:"tr",align:null})),(0,l.yg)("tr",{parentName:"tbody"},(0,l.yg)("td",{parentName:"tr",align:null},"Float64"),(0,l.yg)("td",{parentName:"tr",align:null},"double"),(0,l.yg)("td",{parentName:"tr",align:null},"double()"),(0,l.yg)("td",{parentName:"tr",align:null})),(0,l.yg)("tr",{parentName:"tbody"},(0,l.yg)("td",{parentName:"tr",align:null},"Decimal(P, S)"),(0,l.yg)("td",{parentName:"tr",align:null},"-"),(0,l.yg)("td",{parentName:"tr",align:null},"CAST(source AS DECIMAL(P, S))"),(0,l.yg)("td",{parentName:"tr",align:null},"Decimal32(S), Decimal64(S), Decimal128(S)\xa0Can be used")),(0,l.yg)("tr",{parentName:"tbody"},(0,l.yg)("td",{parentName:"tr",align:null},"Array(T)"),(0,l.yg)("td",{parentName:"tr",align:null},"-"),(0,l.yg)("td",{parentName:"tr",align:null},"-"),(0,l.yg)("td",{parentName:"tr",align:null})),(0,l.yg)("tr",{parentName:"tbody"},(0,l.yg)("td",{parentName:"tr",align:null},"Nullable(T)"),(0,l.yg)("td",{parentName:"tr",align:null},"Depends on T"),(0,l.yg)("td",{parentName:"tr",align:null},"Depends on T"),(0,l.yg)("td",{parentName:"tr",align:null})),(0,l.yg)("tr",{parentName:"tbody"},(0,l.yg)("td",{parentName:"tr",align:null},"LowCardinality(T)"),(0,l.yg)("td",{parentName:"tr",align:null},"Depends on T"),(0,l.yg)("td",{parentName:"tr",align:null},"Depends on T"),(0,l.yg)("td",{parentName:"tr",align:null})))),(0,l.yg)("h2",{id:"examples"},"Examples"),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-bash"},'ClickhouseFile {\n    host = "localhost:8123"\n    database = "nginx"\n    table = "access_msg"\n    fields = ["date", "datetime", "hostname", "http_code", "data_size", "ua", "request_time"]\n    username = "username"\n    password = "password"\n    clickhouse_local_path = "/usr/bin/clickhouse-local"\n    node_free_password = true\n}\n')),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-bash"},'ClickhouseFile {\n    host = "localhost:8123"\n    database = "nginx"\n    table = "access_msg"\n    fields = ["date", "datetime", "hostname", "http_code", "data_size", "ua", "request_time"]\n    username = "username"\n    password = "password"\n    sharding_key = "age"\n    clickhouse_local_path = "/usr/bin/Clickhouse local"\n    node_pass = [\n      {\n        node_address = "localhost1"\n        password = "password"\n      }\n      {\n        node_address = "localhost2"\n        password = "password"\n      }\n    ]\n}\n')))}y.isMDXComponent=!0}}]);